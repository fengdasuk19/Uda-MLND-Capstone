 from crypt comments math ncsu edu subject cryptography faq zero five one zero product ciphers organization the crypt cabal lines four three five expires two two may one nine nine three zero four zero zero zero seven gmt reply to crypt comments math ncsu edu nntp posting host pad thai aktis com summary part five of one zero of the sci crypt faq product ciphers theory and security of product ciphers differential cryptanalysis des encryption standard nsa role in des design des hardware and software availability x last updated one nine nine three zero four one six archive name cryptography faq part zero five last modified one nine nine three four one five faq for sci crypt part five product ciphers this is the fifth of ten parts of the sci crypt faq the parts are mostly independent but you should read the first part before the rest we don t have the time to send out missing parts by mail so don t ask notes such as kah six seven refer to the reference list in the last part the sections of this faq are available via anonymous ftp to rtfm mit edu as pub usenet news answers cryptography faq partxx the cryptography faq is posted to the newsgroups sci crypt sci answers and news answers every two one days contents what is a product cipher what makes a product cipher secure what are some group theoretic properties of product ciphers what can be proven about the security of a product cipher how are block ciphers used to encrypt data longer than the block size can symmetric block ciphers be used for message authentication what exactly is des what is triple des what is differential cryptanalysis how was nsa involved in the design of des is des available in software is des available in hardware can des be used to protect classified information what are ecb cbc cfb and ofb encryption what is a product cipher a product cipher is a block cipher that iterates several weak operations such as substitution transposition modular addition multiplication and linear transformation a block cipher just means a cipher that encrypts a block of data eight bytes say all at once then goes on to the next block the notion of product ciphers is due to shannon sha four nine examples of modern product ciphers include lucifer sor eight four des nbs seven seven sp networks kam seven eight loki bro nine zero feal shi eight four pes lai nine zero khufu and khafre me nine one a the so called feistel ciphers are a class of product ciphers which operate on one half of the ciphertext at each round and then swap the ciphertext halves after each round lucifer des loki and feal are examples of feistel ciphers the following table compares the main parameters of several product ciphers cipher block length key bits number of rounds lucifer one two eight one two eight one six des six four five six one six loki six four six four one six feal six four one two eight two x x five pes six four one two eight eight what makes a product cipher secure nobody knows how to prove mathematically that a product cipher is completely secure so in practice one begins by demonstrating that the cipher looks highly random for example the cipher must be nonlinear and it must produce ciphertext which functionally depends on every bit of the plaintext and the key meyer mey seven eight has shown that at least five rounds of des are required to guarantee such a dependence in this sense a product cipher should act as a mixing function which combines the plaintext key and ciphertext in a complex nonlinear fashion the fixed per round substitutions of the product cipher are referred to as s boxes for example lucifer has two s boxes and des has eight s boxes the nonlinearity of a product cipher reduces to a careful design of these s boxes a list of partial design criteria for the s boxes of des which apply to s boxes in general may be found in brown bro eight nine and brickell et al bri eight six what are some group theoretic properties of product ciphers let e be a product cipher that maps n bit blocks to n bit blocks let e k x be the encryption of x under key k then for any fixed k the map sending x to e k x is a permutation of the set of n bit blocks denote this permutation by p k the set of all n bit permutations is called the symmetric group and is written s the collection of all these permutations p k where k ranges over all possible keys is denoted e s if e were a random mapping from plaintexts to ciphertexts then we would expect e s to generate a large subset of s coppersmith and grossman cop seven four have shown that a very simple product cipher can generate the alternating group a given a sufficient number of rounds the alternating group is half of the symmetric group it consists of all even permutations i e all permutations which can be written as an even number of swaps even and goldreich eve eight three were able to extend these results to show that feistel ciphers can generate a given a sufficient number of rounds the security of multiple encipherment also depends on the group theoretic properties of a cipher multiple encipherment is an extension over single encipherment if for keys k one k two there does not exist a third key k three such that e k two e k one x e k three x which indicates that encrypting twice with two independent keys k one k two is equal to a single encryption under the third key k three if for every k one k two there exists a k three such that eq is true then we say that e is a group this question of whether des is a group under this definition was extensively studied by sherman kaliski and rivest she eight eight in their paper they give strong evidence for the hypothesis that des is not a group in fact des is not a group cam nine three what can be proven about the security of a product cipher recall from above that p k is a permutation produced by e under some key k the goal of the designer of e is to ensure that p k appears to be a random element of s the symmetric group let r be an element of s selected randomly we will say that p k and r are indistinguishable if an observer given p k and r in some order cannot distinguish between these two permutations in polynomial time that is with time bounded resources the observer cannot determine which of the permutations is produced by e the optimal decision is no better than simply guessing luby and rackoff lub eight eight have shown that a class of feistel ciphers are secure in this sense when the round mapping is replaced by random boolean functions how are block ciphers used to encrypt data longer than the block size there are four standard modes of operation and numerous non standard ones as well the standard modes of operation are defined in the u s department of commerce federal information processing standard fips eight one published in one nine eight zero see the question about ecb below for more details although they are defined for the des block cipher the modes of operation can be used with any block cipher can symmetric block ciphers be used for message authentication one may use a symmetric cryptosystem block cipher to prove to himself that he did or did not generate a message and to prove to himself whether his message was altered or unaltered since generation but one cannot prove these things to another without revealing the key and thereafter that key cannot be used to prove anything about any messages that were authenticated using that key see ansi x three one zero six one nine eight three and fips one one three one nine eight five for a standard method of message authentication using des what exactly is des des is the u s government s data encryption standard a product cipher that operates on six four bit blocks of data using a five six bit key it is defined in fips four six one one nine eight eight which supersedes fips four six one nine seven seven fips are federal information processing standards published by ntis des is identical to the ansi standard data encryption algorithm dea defined in ansi x three nine two one nine eight one what is triple des triple des is a product cipher which like des operates on six four bit data blocks there are several forms each of which uses the des cipher three times some forms use two five six bit keys some use three the des modes of operation may also be used with triple des some people refer to e k one d k two e k one x as triple des this method is defined in chapter seven two of the ansi standard x nine one seven one nine eight five financial institution key management and is intended for use in encrypting des keys and ivs for automated key distribution its formal name is encryption and decryption of a single key by a key pair but it is referenced in other standards documents as ede that standard says section seven two one key encrypting keys may be a single dea key or a dea key pair key pairs shoud be used where additional security is needed e g the data protected by the key s has a long security life a key pair shall not be encrypted or decrypted using a single key others use the term triple des for e k one d k two e k three x or e k one e k two e k three x one of us carl ellison keeps advocating des triple use in the form e k one tran e k two tran e k three compress x where each des instance has its own key and iv for cbc mode and tran has been posted on sci crypt it is a large block transposition program taking its key from the data stream itself so that it is not an encryption program on its own part what is differential cryptanalysis differential cryptanalysis is a statistical attack that can be applied to any iterated mapping ie any mapping which is based on a repeated round function the method was recently popularized by biham and shamir bih nine one but coppersmith has remarked that the s boxes of des were optimized against this attack some two zero years ago this method has proved effective against several product ciphers notably feal bi nine one a differential cryptanalysis is based on observing a large number of ciphertexts y y whose corresponding plaintexts x x satisfy a known difference d x x where is componentwise xor in the basic biham shamir attack two such plaintext pairs are required to determine the key for des substantially fewer pairs are required if des is truncated to six or eight rounds in these cases the actual key can be recovered in a matter of minutes using a few thousand pairs for full des this attack is impractical because it requires so many known plaintexts the work of biham and shamir on des revealed several startling observations on the algorithm most importantly if the key schedule was removed from des and a one six four eight seven six eight bit key was used the key could be recovered in less than two steps thus independent subkeys do not add substantial security to des further the s boxes of des are extremely sensitive in that changing even single entries in these tables yields significant improvement in the differential attack adi shamir is quoted to say nytimes oct one three one nine nine one i would say that contrary to what some people believe there is no evidence of tampering with the des so that the basic design was weakened how was nsa involved in the design of des according to kinnucan kin seven eight tuchman a member of the group that developed des at ibm is quoted as saying we developed the des algorithm entirely within ibm using ibmers the nsa did not dictate a single wire tuchman and meyer another developer of des spent a year breaking ciphers and finding weaknesses in lucifer they then spent two years strengthening lucifer their basic approach was to look for strong substitution permutation and key scheduling functions ibm has classified the notes containing the selection criteria at the request of the nsa the nsa told us we had inadvertently reinvented some of the deep secrets it uses to make its own algorithms explains tuchman on the other hand a document called involvement of the nsa in the development of des unclassified summary of the united states select committee on intelligence printed in the ieee communications magazine p five three five five one nine seven eight states in the development of des nsa convinced ibm that a reduced keysize was sufficient indirectly assisted in the development of the s box structures and certified that the final des algorithm was to the best of their knowledge free from any statistical or mathematical weakness clearly the key size was reduced at the insistence of the nsa the article further states that the nsa did not tamper with the algorithm itself just the parameters which in some sense resolves the apparent conflict in the remarks of meyer and tuchman presented above is des available in software several people have made des code available via ftp see part one zero for pathnames stig ostholm ftpso bsd ftpbk eric young ftpey dennis furguson ftpdf mark riordan ftpmr phil karn ftppk a pascal listing of des is also given in patterson pat eight seven fips four six one says the algorithm specified in this standard is to be implemented using hardware not software technology software implementations in general purpose computers are not in compliance with this standard despite this software implementations abound and are used by government agencies is des available in hardware the following paragraphs are quoted from messages sent to the editors we don t vouch for the quality or even existence of the products chip rosenthal says dallas semiconductor makes a des encryption decryption device for use on standard digital six four kbps pcm telecom data streams it is capable of processing data in real time e g one sample frame it is the ds two one six zero their phone number is two one four four five zero zero four zero zero you would probably need to talk with dewight in telecom marketing christian franke franke informatik rwth aachen de says one cryptech cry one two c one zero two two two five mbit s according to data sheet with three two bit interface we use this one because it was the only one available when we started the project no problems two pijnenburg pcc one zero zero two zero mbit s according to data sheet address pijnenburg b v boxtelswweg two six nl five two six one ne vught the netherlands three infosys des chip germany s boxes must be loaded by software so you can modify the algorithm sorry i don t have the data sheet handy please e mail me if you need further information mjr tis com marcus j ranum says supercrypt one zero zero mb sec and faster des and proprietary storage for one six five six bit keys key stream generator integrated hardware des three procedure extended mode with one one two bit keys computer elektronik infosys five one two a herndon parkway herndon va two two zero seven zero eight zero zero three two two three four six four thember gandalf ca tim hember says newbridge microsystems sells an am nine five six eight compatible des chip that operates at two five mhz performs a round of encryption in one eight clocks has a three stage pipeline supports ecb cbc cfb eight and cfb one six four k one k one operators as defined in the c langage electronic code book ecb pn and cn are each six four bits long encryption decryption cn e pn pn d cn cipher block chaining cbc pn and cn are each six four bits long encryption decryption c zero e p zero iv p zero d c zero iv n zero cn e pn cn one pn d cn cn one k bit cipher feedback cfb pn and cn are each k bits long one zero in in one zero in cn one in cn one all n rn e in rn e in all n cn pn rn pn cn rn cfb notes since in depends only on the plain or cipher text from the previous operation the e function can be performed in parallel with the reception of the text with which it is used k bit output feedback ofb pn and cn are each k bits long one zero in in one zero in rn one in rn one all n rn e in rn e in all n cn pn rn pn cn rn ofb notes encryption and decryption are identical since in is independent of p and c the e function can be performed in advance of the receipt of the plain cipher text with which it is to be used additional notes on des modes of operation ecb and cbc use e to encrypt and d to decrypt but the feedback modes use e to both encrypt and decrypt this disproves the erroneous claim that systems which feature e but not d cannot be used for data confidentiality and therefore are not subject to export controls