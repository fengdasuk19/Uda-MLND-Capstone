 from rjn teal csn org robert j niland subject re procomm plus for windows problems nntp posting host teal csn org organization colorado supernet inc x newsreader tin one one pl four lines two nine two kentiler matt ksu ksu edu kent p iler writes i have normal procomm plus for dos but i ve been considering buying the windows version it got really great reviews in computer shopper i have a friend who connects to the mainframe and unix machines here using it but the screen seems to have a problem keeping up with the modem he has a one four four zero zero modem on a four eight six five zero mhz machine i can t see it having trouble keeping up his pcplus for dos works great re what to do after the high speed modem arrives edition zero one apr nine three this article applies only to windows three zero and three one and not to nt os two or dos apps not running under windows one of the unadvertised limitations of most current windows pcs is that their rs two three two c serial com performance is seriously deficient almost everyone who purchases a high speed modem v three two bis v three two pep or hst discovers the problem the first time they try to download a file or accept an incoming fax at nine six zero zero after upgrading the modem overrun and retry errors abound even when the only active application is the datacomm or fax program if the transfer completes at all it may take even longer than with the old two four zero zero bps modem there are three reasons for the problem one the universal asynchronous receiver transmitters uarts used in most pcs are primitive ns eight two five zero devices with single byte fifo buffers if the operating system driver cannot read and flush each character at high interrupt rates the next incoming character overwrites the fifo and the previous one is lost dos being a fairly single minded environment during datacomm can usually keep up windows can t two windows has more operating system overhead than plain dos and interrupts often take longer to service overruns are much more likely than under dos as soon as you report to your pc modem vendor that you are losing data you may be advised that you need to upgrade to a one six five five zero more likely since there seems to be a conspiracy of ignorance about this issue you ll get no useful advice at all most of the store front and mail order sources i spoke with in attempting to solve my own problem had never heard the term one six five five zero and many didn t even know what a uart was three even your pc has ns one six five five zero a uarts and ps two s do or if you can upgrade your mother com board or add a new com board you may still experience errors and overruns because the standard microsoft windows com drivers don t take full advantage of the one six five five zero windows three one is improved in this regard over three zero but i still recommend a driver upgrade applications like procomm win which is what i use cannot get around this problem by themselves if you have a modem card you may not have a problem as the modem part of the card can be designed to be aware of the state of the uart and avoid overrunning it however i wouldn t want to bet that the card designers were that clever and will insist on a one six five five zero uart if i ever buy a modem card some modem cards don t even have conventional uarts but if they are to work with standard windows drivers they need to simulate one use msd exe below to see what the modem card is or is pretending to be the hardware situation the uarts on most pc com ports are based on national semiconductor ns eight two five zero or ns one six four five zero chips or megacells inside vlsi chips where you can t replace them you can id the uart type on your system by running the microsoft diagnostic program windows msd exe be sure to run it in dos before bringing up windows the windows serial api may prevent msd from accurately identifying a one six five five zero if you run it from a windows dos prompt the ns one six five five zero uart has separate one six byte transmit and receive fifos with configurable trigger levels and can run reliably at clock rates up to four six zero eight zero zero bps although with current modem technology there s no point in pushing your luck by going over one one five two zero zero bps the one six five five zero has shorted access cycle times than the one six four five zero or eight two five zero the one six five five zero also has dma capability but it is not clear that any pc drivers ever use this for more technical info see national semiconductor application note an four nine one so what uart component do you have try to locate the uart on your mother board multi function i o card com board or isa mca modem card if you can t find a socketed component with the numbers eight two five zero or one six four five zero your com ports are probably buried in vlsi and you won t be able to perform a chip replacement if you can disable your vlsi com ports as i chose to do you can at least add an aftermarket com board if you have one or more socketed eight two five zero or one six four five zero chips you can buy plug in ns one six five five zero afn or pc one six c five five zero cn low power cmos version ics from several suppliers typically for nine to one five each the n chip is the normal four zero pin dual in line package other styles are available but avoid any ns one six five five zero chips without the a the one six c five five zero c are presumably all ok early ns chips have bugs although national will reportedly exchange those of their own manufacture for free clone chips are available from various ic makers other than national the manual for the turbocom drivers states support for the following apparently equivalent chips national semiconductor one six five five zero a one six five five one one six five five two chips technology eight two c six zero seven texas instruments t one six c five five zero a silicon systems seven three m five five zero vlsi one six c five five zero turbocom warns about the pre a ns one six five five zero and western digital one six c five five zero says that problems have been reported with early ibm ps two five five sx and seven zero systems ibm reportedly will upgrade them if you don t have socketed eight two five zero one six four five zero chips you ll need to buy an after market com or multi function board if this is a modem card situation you may be hosed to add a new com or multi function card you ll need to either disable the com one two port s you are replacing or re assign them to com three four although watch out for irq conflicts without turbocom although cheaper cards are available in the interest of getting the problem solved quickly i elected buy the modular circuit technology mct aio card from jdr microdevices two two three three samaritan drive san jose ca nine five one two four eight zero zero five three eight five zero zero zero voice us four zero eight five five nine one two zero zero voice other eight zero zero five three eight five zero zero five fax us the mct aio and the is important sells for eight nine nine five it is an eight bit isa card providing port type connector address and irq comments com db nine m com one two three irq two three four five ns one six five five zero afn in socket com ribbon com two three four irq two three four five ns one six five five zero afn in socket parallel db two five f lpt one two three irq five seven game ribbon the kit includes a ribbon cable and db two five f connector for the secondary com port a ribbon cable connector for the game port two bulkhead plates for the ribbon based connectors and a nine f to two five f adaptor cable each port can be individually disabled and the com ports have tx rx rts cts dtr dcd and dsr jumpers jdr also sells a super i o m f card that also has ide i have heard from several people about less expensive m f i o cards with one six five five zero s tsd systems four zero seven three three one nine one three zero one nine nine five for the card plus nine nine five per one six five five zero greenfield trading and distributors five one eight two seven one two four seven three voice five one eight two seven one seven eight one one fax their card is three three w one one six five five zero four five w two and they sell one six five five zero afns for one three r s data systems inc eight two zero east highway four three four longwood fl three two seven five zero phone four zero seven three three one one four two four fax four zero seven three three one eight six zero six two com lpt game card w two one six five five zero s for three nine i have no personal experience with any of the firms except jdr meanwhile back at the mct card from jdr i only needed two serial ports and am running out of irqs on my pc so i disabled my built in vlsi based eight two five zero ports however with the turbocom driver below i could have set the internals as com three and four using irq sharing the software situation simply upgrading to one six five five zero uarts will not completely solve common overrun problems the standard ms serial drivers don t take full advantage of the one six five five zero the windows three zero drivers are even less capable and the windows three one drivers have the following limitations they enable only the receive fifo and only at rates above two four zero zero bps they never enable the transmit fifo which results in an interrupt rate of one zero x during uploads they set the trigger level at one four bytes too high it s easy for two more bytes to arrive before the driver can read the fifo the ports menu of the control panel only allows speeds up to one nine two zero zero with a v three two bis modem sparse data and text can easily compress three one or more suggesting that a host dte connect rate of five seven six zero zero bps would be effective the api won t accept rates above cbr one two eight zero zero zero the api won t let dos programs know there is a one six five five zero there and even if it did dos programs that aren t one six five five zero aware get little benefit from a one six five five zero port with the standard drivers they don t allow irq sharing for com three four the bios doesn t initialize com three four properly in many systems windows provides no workaround for apps that don t provide port speed options above one nine two zero zero bps these problems are reportedly not solved in windows nt or dos six zero and may or may not be addressed in any windows releases after three one but before four zero rumors suggest they may be solved in windows four zero you can get replacement drivers that solve all of those problems by buying a copy of turbocom current version one two from bio engineering research pacific commware division one eight zero beacon hill lane ashland or nine seven five two zero nine seven zero one five zero three four eight two two seven four four voice five zero three four eight two two six two seven fax five zero three four eight two two six three three bbs mcimail three four four five three seven four compuserve seven one five two one seven six zero price was around five zero as i recall bio eng is not set up to accept credit cards so i had to send a check egghead and one eight zero zero software list turbocom but as far as i know they don t stock it bio is not a software company per se they apparently needed reliable hi speed serial connections for an in house instrument application wrote their own driver discovered a market for it revised it to be a general purpose com driver suite they recently upgraded it for windows three one it is run time licensed i now have my host dte connect rate set to five seven six zero zero bps most of my datacomm apps and i am having zero problems with downloads i routinely see transfer rates that exceed two zero zero zero bps i am also using one one five two zero zero bps when linking an hp nine five lx to my pc with lossless bi directional i o uploads to various remote systems are another matter because many hosts are still using antique uarts and drivers note that one nine two zero zero is still the highest rate that the windows three one port menu in control panel will allow in configuring a com port turbocom gets around this by allowing you to specify on each port a factor that will set the real uart rate to a multiple of the rate passed through the windows apis and dialog boxes i also have cts rts hardware flow control enabled and i suggest that you do the same even if you only ever transfer seven bit ascii data xon xoff is not a sufficiently reliable method of flow control the informal dec standard for xon xoff hysteresis is that the sender may transmit another one six yes sixteen bytes after receipt of the xoff from the receiving system or device the one six byte fifo in the one six five five zero is clearly not big enough to let us rely exclusively on xon xoff a well respected datacomm engineer has informed me that the one six five five zero s can t really do cts rts all by itself in the dos windows environment so using data rates above one one five two zero zero may still be risky even with hardware flow control a one six five five zero with turbocom can still experience overruns in very busy systems with lots of apps running and serious swapping in progress if this is your situation you may need to buy a co processed com board but this will cost you more than a one six five five zero turbocom upgrade a review of two such boards and a review of turbocom can be found in the feb nine three issue of windows sources magazine i suggest trying a one six five five zero turbocom upgrade first and experiment with process priorities and time slices if you are a power user whose thrashing system still runs into comm problems closing soapbox comments the state of rs two three two c serial datacomm support is an embarrassment across the computer industry because it is the oldest standard i o interface the job of designing hardware and writing software often seems to be assigned to the least senior or lowest ranked engineers at computer companies the design of the average serial port is at least ten years behind the state of the art in my last job with a major workstation vendor i lobbied for improved serial ports when they were doing the initial designs of a new system that family of machines was subsequently introduced with one six five five zero ports however this is the exception few computer companies seem to have any champions for decent i o you may as well learn what you can about serial i o because this situation shows no sign of improving soon when v fast arrives i expect cries of outrage from windows users world wide whose eight two five zero pcs sort of work today with v three two but will fail miserably with v fast without a hardware buffered uart like the one six five five zero and without software drivers that use that uart to best advantage a v fast modem will be a waste of money regards one zero zero one a east harmony road bob niland suite five zero three internet rjn csn org fort collins co eight zero five two five compuserve seven one zero four four two one two four three zero three two two three five two zero nine copyright one nine nine three robert j niland all rights reserved permission is granted for automatic redistribution of this article via electronic magnetic and optical media in an unedited form through any usenet newsgroup where the article is posted by the author permission is granted for each compuserve and usenet reader subscriber and each person who received this article from compuserve an ftp site authorized by the author or via electronic mail from the author to retain one electronic copy and to make hardcopy reproductions of this edition of this article for personal non commercial use provided that no material changes are made to the article or this copyright statement all other copying storage reproduction or redistribution of this article in any form is prohibited without the express written consent of the author robert j niland eof